{{define "header"}}
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Title -->
    <title>{{if .Title}}Car Forum - {{.Title}}{{else}}Car Forum{{end}}</title>

    <!-- Styles -->
    <link rel="stylesheet" href="/static/stylesheets/style.css" />
    <link rel="icon" type="image/x-icon" href="/static/assets/favicon.ico" />
    <link rel="logo" type="image/png" href="/static/assets/logo.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body>
    <header>
      <nav>
        <ul class="nav-list">
          <li class="logo">
            <a href="/"
              ><img src="/static/assets/logo.png" alt="Car Forum Logo"
            /></a>
          </li>

          <input type="checkbox" id="check" />
          <span class="menu">
            <li class="nav-link">
              <a href="/">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 -960 960 960"
                >
                  <path
                    d="M180-120q-25 0-42.5-17.5T120-180v-76l160-142v278H180Zm140 0v-160h320v160H320Zm360 0v-328L509-600l121-107 190 169q10 9 15 20.5t5 24.5v313q0 25-17.5 42.5T780-120H680ZM120-310v-183q0-13 5-25t15-20l300-266q8-8 18.5-11.5T480-819q11 0 21.5 3.5T520-804l80 71-480 423Z"
                  />
                </svg>
                Home
              </a>
            </li>

            <li class="nav-link">
              <a href="/#all-posts"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 -960 960 960"
                >
                  <path
                    d="M280-240q-17 0-28.5-11.5T240-280v-80h520v-360h80q17 0 28.5 11.5T880-680v600L720-240H280ZM80-280v-560q0-17 11.5-28.5T120-880h520q17 0 28.5 11.5T680-840v360q0 17-11.5 28.5T640-440H240L80-280Zm520-240v-280H160v280h440Zm-440 0v-280 280Z"
                  />
                </svg>
                Posts
              </a>
            </li>

            <li class="nav-link">
              <div class="categories-wrapper">
                <label for="category-toggle" class="category-link">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 -960 960 960"
                  >
                    <path
                      d="M480-400 40-640l440-240 440 240-440 240Zm0 160L63-467l84-46 333 182 333-182 84 46-417 227Zm0 160L63-307l84-46 333 182 333-182 84 46L480-80Zm0-411 273-149-273-149-273 149 273 149Zm0-149Z"
                    />
                  </svg>
                  Categories
                  <i class="fas fa-caret-down" id="open-collapse"></i>
                </label>
                <div class="dropdown">
                  <div class="arrow"></div>
                  <ul>
                    {{if .NavbarOptions}} {{range .NavbarOptions}}
                    <li class="dropdown-link">
                      <a href="/category/{{.ID}}">{{.Name}}</a>
                    </li>
                    {{end}} {{end}}
                  </ul>
                </div>
              </div>

              <div class="collapsible-menu">
                {{if .NavbarOptions}} {{range .NavbarOptions}}
                <div><a href="/category/{{.ID}}">{{.Name}}</a></div>
                {{end}} {{end}}
              </div>
            </li>
            <label for="check" class="close-menu"
              ><i class="fas fa-times"></i
            ></label>
          </span>
          <label for="check" class="open-menu"
            ><i class="fas fa-bars"></i
          ></label>
        </ul>

        <div class="nav-btn">
          {{if .IsAuthenticated}}
          <div class="user-info-wrapper">
            <label for="user-toggle" class="user-info">
              <img
                src="{{.User.ProfilePicture}}"
                alt=""
                style="border-radius: 5px"
                width="30"
                height="30"
              />
              <span>{{.User.Username}}<i class="fas fa-caret-down"></i></span>
            </label>

            <div class="user-dropdown">
              <div class="arrow"></div>
              <a href="/logout" id="logout" class="logout-btn">Logout</a>
            </div>
          </div>
          {{else}}
          <a href="/login" id="login"
            ><button class="login-btn">Login</button></a
          >
          <a href="/register" id="register" class="btn-outline">Register</a>
          {{end}}
        </div>
      </nav>
    </header>

    <main style="padding: 20px">{{end}}</main>

    <!-- footer -->
    {{define "footer"}}
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <h3>About Us</h3>
          <p>
            The Car Forum is an online community for automotive enthusiasts to
            discuss, share knowledge, and connect with other car lovers. The
            forum covers a wide range of topics including general car
            discussions, maintenance/repairs, modifications, racing,
            buying/selling vehicles, and regional sections. It provides a
            friendly, knowledgeable environment for car fans to learn, share
            their passions, and interact with like-mindedÂ members.
          </p>
        </div>
        <div class="footer-section">
          <div class="links">
            <h3>Quick Links</h3>
            <ul>
              <li><a href="/">Home</a></li>
              <li><a href="/#all-posts">Posts</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; <span id="year"></span> Car Forum. All rights reserved.</p>
        <script>
          document.getElementById("year").textContent =
            new Date().getFullYear();
        </script>
      </div>
    </footer>
  </body>

  <script>
    const formatDate = document.querySelectorAll(".date");
    formatDate.forEach((date) => {
      date.textContent = new Date(date.textContent).toLocaleDateString(
        "en-US",
        {
          year: "numeric",
          month: "short",
          day: "numeric",
        }
      );
    });

    const userInfoWrapper = document.querySelector(".user-info-wrapper");
    const userDropdown = document.querySelector(".user-dropdown");
    let hideTimeout;

    if (userInfoWrapper) {
      userInfoWrapper.addEventListener("mouseenter", () => {
        clearTimeout(hideTimeout);
        userDropdown.classList.add("open-user-dropdown");
      });

      userInfoWrapper.addEventListener("mouseleave", () => {
        hideTimeout = setTimeout(() => {
          userDropdown.classList.remove("open-user-dropdown");
        }, 100); // Adjust the delay as needed
      });
    }

    const openCollapse = document.getElementById("open-collapse");

    openCollapse.addEventListener("click", () => {
      const collapsibleMenu = document.querySelector(".collapsible-menu");
      collapsibleMenu.classList.toggle("open-collapsible-menu");
    });

    const categoriesWrapper = document.querySelector(".categories-wrapper");
    const dropdown = document.querySelector(".dropdown");

    categoriesWrapper.addEventListener("mouseenter", () => {
      clearTimeout(hideTimeout);
      dropdown.classList.add("open-dropdown");
    });

    categoriesWrapper.addEventListener("mouseleave", () => {
      const dropdown = document.querySelector(".dropdown");
      hideTimeout = setTimeout(() => {
        dropdown.classList.remove("open-dropdown");
      }, 100);
    });

    const formatTime = document.querySelectorAll(".time");

    // turn it to 2 minutes ago, 3 hours ago, etc

    formatTime.forEach((time) => {
      const date = new Date(time.textContent);
      const now = new Date();
      const diff = now - date;

      const seconds = Math.floor(diff / 1000);
      const minutes = Math.floor(seconds / 60);
      const hours = Math.floor(minutes / 60);
      const days = Math.floor(hours / 24);

      if (days > 0) {
        time.textContent = `${days} days ago`;
      } else if (hours > 0) {
        time.textContent = `${hours} hours ago`;
      } else if (minutes > 0) {
        time.textContent = `${minutes} minutes ago`;
      } else {
        time.textContent = `${seconds} seconds ago`;
      }
    });
  </script>
</html>
{{end}}
